<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reportes - CaminoSeguro</title>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?display=swap&family=Inter:wght@400;500;700;900&family=Noto+Sans:wght@400;500;700;900">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg viewBox='0 0 48 48' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M13.8261 17.4264C16.7203 18.1174 20.2244 18.5217 24 18.5217C27.7756 18.5217 31.2797 18.1174 34.1739 17.4264C36.9144 16.7722 39.9967 15.2331 41.3563 14.1648L24.8486 40.6391C24.4571 41.267 23.5429 41.267 23.1514 40.6391L6.64374 14.1648C8.00331 15.2331 11.0856 16.7722 13.8261 17.4264Z' fill='%230d59f2'/%3E%3C/svg%3E">
    <style>
      .select-arrow {
        background-image: url('data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724px%27 height=%2724px%27 fill=%27rgb(69,116,161)%27 viewBox=%270 0 256 256%27%3e%3cpath d=%27M181.66,170.34a8,8,0,0,1,0,11.32l-48,48a8,8,0,0,1-11.32,0l-48-48a8,8,0,0,1,11.32-11.32L128,212.69l42.34-42.35A8,8,0,0,1,181.66,170.34Zm-96-84.68L128,43.31l42.34,42.35a8,8,0,0,0,11.32-11.32l-48-48a8,8,0,0,0-11.32,0l-48,48A8,8,0,0,0,85.66,85.66Z%27%3e%3c/path%3e%3c/svg%3e');
        background-position: right 1rem center;
        background-repeat: no-repeat;
        appearance: none;
      }
    </style>
</head>
<body>
    <div class="relative flex h-auto min-h-screen w-full flex-col bg-slate-50 group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <!-- Header -->
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#e6edf4] px-10 py-3">
          <a href="../index.html" class="flex items-center gap-2 text-[#0c151d]">
            <img src="../imagenes/logoconnombre.jpeg" alt="CaminoSeguro" class="h-10 object-contain">
          </a>
          <div class="flex items-center gap-4">
            <span id="userName" class="text-[#4574a1] text-sm"></span>
            <button onclick="auth.logout()" class="flex min-w-[84px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#e6edf4] text-[#0c151d] text-sm font-bold leading-normal tracking-[0.015em] hover:bg-[#ced7e8] transition-colors">
              <span class="truncate">Cerrar Sesión</span>
            </button>
          </div>
        </header>

        <div class="flex flex-1">
          <!-- Sidebar -->
          <nav class="w-64 bg-white border-r border-[#e6edf4] p-4">
            <ul class="space-y-2">
              <li>
                <a href="dashboard.html" class="flex items-center gap-3 px-4 py-3 rounded-lg text-[#4574a1] hover:bg-[#e6edf4] transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40Zm0,160H40V56H216V200ZM184,96a8,8,0,0,1-8,8H80a8,8,0,0,1,0-16h96A8,8,0,0,1,184,96Zm0,32a8,8,0,0,1-8,8H80a8,8,0,0,1,0-16h96A8,8,0,0,1,184,128Zm0,32a8,8,0,0,1-8,8H80a8,8,0,0,1,0-16h96A8,8,0,0,1,184,160Z"/></svg>
                  Dashboard
                </a>
              </li>
              <li>
                <a href="reportes.html" class="flex items-center gap-3 px-4 py-3 rounded-lg bg-[#e6edf4] text-[#0c151d] font-medium">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"/></svg>
                  Reportes
                </a>
              </li>
              <li>
                <a href="rutas-seguras.html" class="flex items-center gap-3 px-4 py-3 rounded-lg text-[#4574a1] hover:bg-[#e6edf4] transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M200,224H150.54A266.56,266.56,0,0,0,174,200.25c27.45-31.57,42-64.85,42-96.25a88,88,0,0,0-176,0c0,31.4,14.51,64.68,42,96.25A266.56,266.56,0,0,0,105.46,224H56a8,8,0,0,0,0,16H200a8,8,0,0,0,0-16ZM56,104a72,72,0,0,1,144,0c0,57.23-55.47,105-72,118C111.47,209,56,161.23,56,104Zm112,0a40,40,0,1,0-40,40A40,40,0,0,0,168,104Zm-64,0a24,24,0,1,1,24,24A24,24,0,0,1,104,104Z"/></svg>
                  Rutas Seguras
                </a>
              </li>
              <li>
                <a href="mapas-calor.html" class="flex items-center gap-3 px-4 py-3 rounded-lg text-[#4574a1] hover:bg-[#e6edf4] transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M128,16a88.1,88.1,0,0,0-88,88c0,75.3,80,132.17,83.41,134.55a8,8,0,0,0,9.18,0C136,236.17,216,179.3,216,104A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"/></svg>
                  Mapas de Calor
                </a>
              </li>
              <li>
                <a href="puntos-ayuda.html" class="flex items-center gap-3 px-4 py-3 rounded-lg text-[#4574a1] hover:bg-[#e6edf4] transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"/></svg>
                  Puntos de Ayuda
                </a>
              </li>
              <li>
                <a href="educacion.html" class="flex items-center gap-3 px-4 py-3 rounded-lg text-[#4574a1] hover:bg-[#e6edf4] transition-colors">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M251.76,88.94l-120-64a8,8,0,0,0-7.52,0l-120,64a8,8,0,0,0,0,14.12L32,117.87v48.42a15.91,15.91,0,0,0,4.06,10.65C49.16,191.53,78.51,216,128,216a130,130,0,0,0,48-8.76V240a8,8,0,0,0,16,0V199.51a115.63,115.63,0,0,0,27.94-22.57A15.91,15.91,0,0,0,224,166.29V117.87l27.76-14.81a8,8,0,0,0,0-14.12ZM128,200c-43.27,0-68.72-21.14-80-33.71V126.4l76.24,40.66a8,8,0,0,0,7.52,0L176,143.47v46.34C163.4,195.69,147.52,200,128,200Zm80-33.75a97.83,97.83,0,0,1-16,14.25V134.93l16-8.53ZM188,118.94l-.22-.13-56-29.87a8,8,0,0,0-7.52,14.12L171,128l-43,22.93L25,96,128,41.07,231,96Z"/></svg>
                  Educación Preventiva
                </a>
              </li>
            </ul>
          </nav>

          <!-- Main Content -->
          <main class="flex-1 p-8">
            <div class="flex items-center justify-between mb-6">
              <h1 class="text-[#0c151d] text-2xl font-bold">Reportar Incidente</h1>
            </div>
            
            <!-- Report Form -->
            <div class="bg-white rounded-xl shadow-sm border border-[#e6edf4] p-6 mb-8 max-w-2xl">
              <form id="reportForm">
                <div id="errorContainer"></div>
                <div id="successContainer"></div>
                
                <div class="mb-6">
                  <label class="block text-[#0c151d] text-base font-medium mb-2">Tipo de incidente</label>
                  <select
                    id="incidentType"
                    required
                    class="select-arrow w-full rounded-lg text-[#0c151d] border-none bg-[#e6edf4] h-14 px-4 text-base"
                  >
                    <option value="">Seleccione el tipo de incidente</option>
                    <option value="robo">Robo</option>
                    <option value="asalto">Asalto</option>
                    <option value="acoso">Acoso callejero</option>
                    <option value="vandalismo">Vandalismo</option>
                    <option value="accidente">Accidente de tránsito</option>
                    <option value="iluminacion">Falta de iluminación</option>
                    <option value="sospechoso">Actividad sospechosa</option>
                    <option value="otro">Otro</option>
                  </select>
                </div>
                
                <div class="mb-6">
                  <label class="block text-[#0c151d] text-base font-medium mb-2">Ubicación</label>
                  <input
                    type="text"
                    id="location"
                    placeholder="Ingrese la dirección o use el mapa"
                    required
                    class="w-full rounded-lg text-[#0c151d] border-none bg-[#e6edf4] h-14 px-4 text-base placeholder:text-[#4574a1]"
                  />
                  <button type="button" onclick="getCurrentLocation()" class="mt-2 text-[#359dff] text-sm hover:underline flex items-center gap-1">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256"><path d="M128,16a88.1,88.1,0,0,0-88,88c0,75.3,80,132.17,83.41,134.55a8,8,0,0,0,9.18,0C136,236.17,216,179.3,216,104A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"/></svg>
                    Usar mi ubicación actual
                  </button>
                </div>
                
                <div class="mb-6">
                  <label class="block text-[#0c151d] text-base font-medium mb-2">Descripción</label>
                  <textarea
                    id="description"
                    rows="4"
                    placeholder="Describa lo ocurrido con el mayor detalle posible"
                    required
                    class="w-full rounded-lg text-[#0c151d] border-none bg-[#e6edf4] p-4 text-base placeholder:text-[#4574a1] resize-none"
                  ></textarea>
                </div>
                
                <div class="mb-6">
                  <label class="block text-[#0c151d] text-base font-medium mb-2">Fecha y hora del incidente</label>
                  <input
                    type="datetime-local"
                    id="incidentDate"
                    class="w-full rounded-lg text-[#0c151d] border-none bg-[#e6edf4] h-14 px-4 text-base"
                  />
                </div>
                
                <div class="mb-6">
                  <label class="block text-[#0c151d] text-base font-medium mb-2">Evidencia (opcional)</label>
                  <div class="border-2 border-dashed border-[#e6edf4] rounded-lg p-8 text-center hover:border-[#359dff] transition-colors">
                    <input type="file" id="evidence" accept="image/*" class="hidden" onchange="handleFileSelect(this)">
                    <div id="uploadArea" onclick="document.getElementById('evidence').click()" class="cursor-pointer">
                      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="#4574a1" viewBox="0 0 256 256" class="mx-auto mb-2"><path d="M209.66,122.34a8,8,0,0,1,0,11.32l-82.05,82a56,56,0,0,1-79.2-79.21l99.29-100.29a40,40,0,1,1,56.57,56.56l-99.29,100.29a24,24,0,0,1-33.94-33.94l83-84a8,8,0,0,1,11.32,11.31l-83,84a8,8,0,0,0,11.31,11.31l99.29-100.29a24,24,0,1,0-33.94-33.94L60,147.57a40,40,0,0,0,56.57,56.56l82.05-82A8,8,0,0,1,209.66,122.34Z"/></svg>
                      <p class="text-[#4574a1]">Haz clic o arrastra una imagen aquí</p>
                      <p class="text-[#4574a1] text-sm mt-1">PNG, JPG hasta 5MB</p>
                    </div>
                    <div id="previewArea" class="hidden">
                      <img id="imagePreview" class="max-h-40 mx-auto rounded-lg">
                      <button type="button" onclick="removeFile()" class="mt-2 text-red-500 text-sm hover:underline">Eliminar imagen</button>
                    </div>
                  </div>
                </div>
                
                <button
                  type="submit"
                  id="submitBtn"
                  class="w-full flex items-center justify-center rounded-lg h-12 bg-[#359dff] text-white font-bold hover:bg-[#2080dd] transition-colors"
                >
                  Enviar Reporte
                </button>
              </form>
            </div>

            <!-- Recent Reports List -->
            <div class="bg-white rounded-xl shadow-sm border border-[#e6edf4]">
              <div class="p-6 border-b border-[#e6edf4]">
                <h2 class="text-[#0c151d] text-lg font-bold">Mis Reportes</h2>
              </div>
              <div id="reportsList" class="p-6">
                <div class="flex items-center justify-center py-8 text-[#4574a1]">
                  <svg class="animate-spin h-6 w-6 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  Cargando reportes...
                </div>
              </div>
            </div>
          </main>
        </div>
      </div>
    </div>

    <script src="../js/app.js"></script>
    <script>
      // Require authentication
      auth.requireAuth();
      
      // Display user name
      const user = auth.getUser();
      if (user) {
        document.getElementById('userName').textContent = `Hola, ${user.fullName || user.email}`;
      }
      
      // Variables para almacenar coordenadas
      let currentLatitude = null;
      let currentLongitude = null;
      
      // Set default datetime to now
      const now = new Date();
      now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
      document.getElementById('incidentDate').value = now.toISOString().slice(0, 16);
      
      // Get current location
      function getCurrentLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            async (position) => {
              const { latitude, longitude } = position.coords;
              currentLatitude = latitude;
              currentLongitude = longitude;
              // Try to reverse geocode
              try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`, {
                  headers: { 'User-Agent': 'CaminoSeguro/1.0' }
                });
                const data = await response.json();
                document.getElementById('location').value = data.display_name || `${latitude}, ${longitude}`;
              } catch {
                document.getElementById('location').value = `${latitude}, ${longitude}`;
              }
            },
            (error) => {
              alert('No se pudo obtener la ubicación: ' + error.message);
            }
          );
        } else {
          alert('La geolocalización no está soportada en este navegador');
        }
      }
      
      // Geocodificar dirección a coordenadas
      async function geocodeAddress(address) {
        try {
          const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address + ', Lima, Perú')}&limit=1`, {
            headers: { 'User-Agent': 'CaminoSeguro/1.0' }
          });
          const data = await response.json();
          if (data && data.length > 0) {
            return {
              lat: parseFloat(data[0].lat),
              lng: parseFloat(data[0].lon)
            };
          }
          return null;
        } catch {
          return null;
        }
      }
      
      // File handling
      function handleFileSelect(input) {
        const file = input.files[0];
        if (file) {
          if (file.size > 5 * 1024 * 1024) {
            alert('El archivo es demasiado grande. Máximo 5MB.');
            return;
          }
          const reader = new FileReader();
          reader.onload = (e) => {
            document.getElementById('imagePreview').src = e.target.result;
            document.getElementById('uploadArea').classList.add('hidden');
            document.getElementById('previewArea').classList.remove('hidden');
          };
          reader.readAsDataURL(file);
        }
      }
      
      function removeFile() {
        document.getElementById('evidence').value = '';
        document.getElementById('uploadArea').classList.remove('hidden');
        document.getElementById('previewArea').classList.add('hidden');
      }
      
      // Submit report
      document.getElementById('reportForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const incidentType = document.getElementById('incidentType').value;
        const location = document.getElementById('location').value;
        const description = document.getElementById('description').value;
        const incidentDate = document.getElementById('incidentDate').value;
        const submitBtn = document.getElementById('submitBtn');
        const errorContainer = document.getElementById('errorContainer');
        const successContainer = document.getElementById('successContainer');
        
        errorContainer.innerHTML = '';
        successContainer.innerHTML = '';
        
        if (!incidentType || !location || !description) {
          ui.showError('Por favor complete todos los campos requeridos', errorContainer);
          return;
        }
        
        ui.showLoading(submitBtn);
        
        try {
          // Si no tenemos coordenadas, intentar geocodificar la dirección
          let lat = currentLatitude;
          let lng = currentLongitude;
          
          if (!lat || !lng) {
            const coords = await geocodeAddress(location);
            if (coords) {
              lat = coords.lat;
              lng = coords.lng;
            } else {
              // Usar coordenadas por defecto de Lima si no se puede geocodificar
              lat = -12.0464;
              lng = -77.0428;
            }
          }
          
          const response = await api.post('/reports', {
            incidentType: incidentType,
            description: description,
            latitude: parseFloat(lat),
            longitude: parseFloat(lng),
            address: location,
            severity: 'medium'
          });
          
          console.log('Reporte enviado:', { incidentType, lat, lng, address: location });
          
          if (response.success) {
            successContainer.innerHTML = `
              <div class="bg-green-50 text-green-800 px-4 py-3 rounded-lg mb-4 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34ZM232,128A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"/></svg>
                ¡Reporte enviado exitosamente!
              </div>
            `;
            e.target.reset();
            removeFile();
            // Reset coordenadas
            currentLatitude = null;
            currentLongitude = null;
            loadReports();
          }
        } catch (error) {
          ui.showError(error.message || 'Error al enviar el reporte', errorContainer);
        } finally {
          ui.hideLoading(submitBtn);
        }
      });
      
      // Load reports
      async function loadReports() {
        const reportsList = document.getElementById('reportsList');
        
        try {
          const response = await api.get('/reports').catch(() => null);
          const reports = response?.data?.reports || [];
          
          if (response && response.success && reports.length > 0) {
            reportsList.innerHTML = reports.map(report => `
              <div class="flex items-start gap-4 py-4 border-b border-[#e6edf4] last:border-0">
                <div class="${getStatusColor(report.status)} p-2 rounded-full">
                  ${getStatusIcon(report.status)}
                </div>
                <div class="flex-1">
                  <div class="flex items-center justify-between">
                    <p class="text-[#0c151d] font-medium">${getTypeName(report.incidentType)}</p>
                    <span class="text-xs px-2 py-1 rounded-full ${getStatusBadge(report.status)}">${getStatusName(report.status)}</span>
                  </div>
                  <p class="text-[#4574a1] text-sm mt-1">${report.location?.address || 'Sin ubicación'}</p>
                  <p class="text-[#4574a1] text-xs mt-2">${formatDate(report.createdAt)}</p>
                </div>
              </div>
            `).join('');
          } else {
            reportsList.innerHTML = `
              <div class="text-center py-8 text-[#4574a1]">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 256 256" class="mx-auto mb-4 opacity-50"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216ZM80,108a12,12,0,1,1,12,12A12,12,0,0,1,80,108Zm96,0a12,12,0,1,1-12-12A12,12,0,0,1,176,108Zm-1.07,48c-10.29,17.79-27.4,28-46.93,28s-36.63-10.2-46.92-28a8,8,0,1,1,13.84-8c7.47,12.91,19.21,20,33.08,20s25.61-7.1,33.07-20a8,8,0,0,1,13.86,8Z"/></svg>
                <p>No tienes reportes aún</p>
                <p class="text-sm mt-1">¡Reporta un incidente para mantener tu comunidad segura!</p>
              </div>
            `;
          }
        } catch (error) {
          reportsList.innerHTML = `
            <div class="text-center py-8 text-[#4574a1]">
              <p>No se pudieron cargar los reportes</p>
            </div>
          `;
        }
      }
      
      function getTypeName(type) {
        const types = {
          robo: 'Robo',
          asalto: 'Asalto',
          acoso: 'Acoso callejero',
          vandalismo: 'Vandalismo',
          accidente: 'Accidente de tránsito',
          iluminacion: 'Falta de iluminación',
          sospechoso: 'Actividad sospechosa',
          otro: 'Otro'
        };
        return types[type] || type;
      }
      
      function getStatusName(status) {
        const statuses = {
          pending: 'Pendiente',
          reviewing: 'En revisión',
          resolved: 'Resuelto',
          rejected: 'Rechazado'
        };
        return statuses[status] || 'Pendiente';
      }
      
      function getStatusColor(status) {
        const colors = {
          pending: 'bg-[#fef3c7]',
          reviewing: 'bg-[#e0e7ff]',
          resolved: 'bg-[#dcfce7]',
          rejected: 'bg-[#fee2e2]'
        };
        return colors[status] || 'bg-[#fef3c7]';
      }
      
      function getStatusBadge(status) {
        const badges = {
          pending: 'bg-[#fef3c7] text-[#92400e]',
          reviewing: 'bg-[#e0e7ff] text-[#3730a3]',
          resolved: 'bg-[#dcfce7] text-[#166534]',
          rejected: 'bg-[#fee2e2] text-[#991b1b]'
        };
        return badges[status] || 'bg-[#fef3c7] text-[#92400e]';
      }
      
      function getStatusIcon(status) {
        if (status === 'resolved') {
          return '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#22c55e" viewBox="0 0 256 256"><path d="M173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34Z"/></svg>';
        }
        return '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#f59e0b" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm-8-80V80a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm20,36a12,12,0,1,1-12-12A12,12,0,0,1,140,172Z"/></svg>';
      }
      
      function formatDate(dateString) {
        if (!dateString) return '';
        const date = new Date(dateString);
        return date.toLocaleDateString('es-PE', {
          day: 'numeric',
          month: 'long',
          year: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
      }
      
      loadReports();
    </script>
</body>
</html>
